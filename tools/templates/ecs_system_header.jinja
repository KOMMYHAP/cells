#pragma once
#include "simulation/simulation_system.h"

{% for resource in system.resources %}
    {% if resource.forward_declaration_only %}
class {{resource.type_name}};
    {% else %}
#include "{{resource.include_path}}"
    {% endif %}
{% endfor %}

{% for component in system.components %}
    {% if not component.is_tag %}
struct {{component.type_name}};
    {% endif %}
{% endfor %}

class {{ system.type_name }} final : public SimulationSystem
{
public:
{% if system.resources|length > 0 %}
    explicit {{ system.type_name }}(
{% else %}
    {{ system.type_name }}(
{% endif %}
{%- for resource in system.resources %}
        {{resource.argument_type}} {{resource.argument_name}}{% if not loop.last %},{% endif %}
{%- endfor -%}
    );

    void DoSystemUpdate() override;

{% if system.is_ecs %}
private:
    {%- if system.components|length > system.tag_components_count %}
    void DoProcessComponents(EcsEntity id,
        {%- for component in system.components %}
            {% if not component.is_tag %}
        {{component.argument_type_and_name}}{% if not loop.last %},{% endif %}
            {% endif %}
        {%- endfor -%}
    );
    {% else %}
    void DoProcessComponents(EcsEntity id);
    {% endif %}
{% endif %}

{% if system.resources|length >= 1 %}
private:
    {%- for resource in system.resources %}
    {{resource.field_type}} _{{resource.argument_name}};
    {%- endfor -%}
{% endif %}
};
